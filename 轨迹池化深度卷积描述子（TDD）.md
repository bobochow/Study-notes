# 轨迹池化深度卷积描述子（TDD）

> Wang L, Qiao Y, Tang X. Action recognition with trajectory-pooled deep-convolutional descriptors[C]//Proceedings of the IEEE conference on computer vision and pattern recognition. 2015: 4305-4314.

## 一、引言

1. 手工提取特征（hand-crafted features）与深度学习特征（deep-learned features）。

   手工提取特征：如STIP、DT、IDT，这类方法可以分为detector和descriptor两个部分。detector根据某种模型提取高运动显著性区域的轨迹等，descriptor根据图像信息对轨迹进行描述（比如之前提到的HOG/HOF/MBH，它们都是descriptor）。

   深度学习特征：直接将视频输入，通过若干卷积层、池化层以及softmax得到预测分类。

2. 存在的问题：

   手工提取特征：未针对视觉表示进行优化，可能缺乏动作判别能力。

   深度学习特征：（1）需要大数据集，目前的数据集还相对较小。（2）没有考虑时间维度和空间维度的差异。

3. 本文贡献：提出了一种轨迹池化深度卷积描述子，融合了手工提取特征和深度学习特征。

4. 总体流程：轨迹提取 -> 使用双流网络计算深度卷积特征图 -> 特征图归一化（时空归一化、通道归一化）-> 轨迹池化（沿轨迹相加）->使用SVM分类。

## 二、轨迹提取

1. 采取与IDT类似的方法进行轨迹提取。

2. 具体步骤：密集采样、去除均匀区域、计算光流、跟踪轨迹。

3. TDD与IDT轨迹提取上的不同点：

   （1）TDD只在原始空间尺度上跟踪轨迹，因为这样更快。多尺度的工作放在深度卷积特征图中。

   （2）TDD只做detector的部分，不做descriptor的部分，将深度卷积特征图认为是descriptor。

## 三、深度卷积描述子

1. 将训练好的双流网络作为特征提取器。

2. 提取时的改进：

   （1）去除最后的全连接层，将每一个卷积层的输出作为特征图。

   （2）在卷积和池化中进行“0”填充，使特征图与原始图像尺度一致，方便后续定位轨迹位置。

3. 每一个空间流卷积层的输出和时间流卷积层的输出组成特征组：
   $$
   C(V)=\{C_1^s,C_2^s,...,C_M^s,C_1^t,C_2^t,...,C_M^t\}\\
   s表示空间流，t表示时间流
   $$

4. 特征图感受野比率：卷积的步长决定感受野比率，步长为2则感受野变为1/2（相当于图像缩了）。

   某一层的特征图感受野比率等于其之前所有卷积和池化的感受野变化的乘积。

   | 层         | conv1 | pool1 | conv2 | pool2 | conv3 | conv4 | conv5 | pool5 |
   | ---------- | ----- | ----- | ----- | ----- | ----- | ----- | ----- | ----- |
   | 步长       | 2     | 2     | 2     | 2     | 1     | 1     | 1     | 1     |
   | 感受野比率 | 1/2   | 1/4   | 1/8   | 1/16  | 1/16  | 1/16  | 1/16  | 1/16  |

5. 归一化：减少光照的影响。

   时空归一化：同一个通道内不同时空点的归一化。

   $$
   \tilde{C}_{st}(x,y,z,n)=C(x,y,z,n)/maxV_{st}^n
   $$
   通道归一化：不同通道相同时空点的归一化。

   $$
   \tilde{C}_{ch}(x,y,z,n)=C(x,y,z,n)/maxV_{ch}^{x,y,z}
   $$

6. 轨迹池化：轨迹上所有点的值（已归一化）相加。

   $$
   D(T_k,\tilde{C}_m^a)=\sum_{p=1}^{P}\tilde{C}_m^a([r_m\times x_p^k],[r_m\times y_p^k],z_p^k)\\
   ([r_m\times x_p^k],[r_m\times y_p^k],z_p^k)是当前感受野下轨迹点的相对位置\\
   T_k是轨迹
   $$

7. 多尺度TDD：将rm换成rm\*s，s是缩放尺度。

## 四、实验结果

1. TDD整体效果比之前的算法好，在UCF101上的准确率达到91.5%，在HMDB51上的准确率达到63.2%。
2. 在TDD中，选取空间流conv4/conv5和时间流conv3/conv4的效果较好。